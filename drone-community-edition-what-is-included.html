<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="Laszlo Fogas, a self employed DevOps consultant going into products">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta content="Drone Community Edition - what is included?" property="og:title">
  <meta content="website" property="og:type">
  <meta content="https://laszlo.cloud/images/1500x500.jpg" property="og:image">
  <meta content="https://laszlo.cloud/laszlo.jpg" property="og:image">
  <meta content="https://laszlo.cloud/drone-community-edition-what-is-included" property="og:url">
  <meta content="Laszlo Fogas" property="og:site_name">
  <meta content="The licensing of Drone 1.0 left a few questions open. In this article I capture what I know about the Drone Community Edition and my experience building the opensource version." property="og:description">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@laszlocph">
  <meta name="twitter:creator" content="@laszlocph">
  <meta name="twitter:title" content="Drone Community Edition - what is included?">
  <meta name="twitter:description" content="The licensing of Drone 1.0 left a few questions open. In this article I capture what I know about the Drone Community Edition and my experience building the opensource version.">
  <meta name="twitter:image" content="https://laszlo.cloud/images/1500x500.jpg">

  <title>Drone Community Edition - what is included? - Laszlo Fogas</title>
  <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/main.css?2">
  <meta name="google-site-verification" content="rRfVaMDPujw_KMAWJY0A3P6wZ3uP8pg2_-Bp0nAbLqg" />

</head>
<body style="position: relative">
  <div class="container mx-auto p-4">
    <div class="flex">
      <div class="hidden md:block md:w-3/12"></div>
      <div class="w-full md:w-6/12 max-w-xl">
        <h1><a href="./">Laszlo Fogas</a></h1>
        <img src="images/1500x500.jpg"/>
      </div>
      <div class="hidden md:block md:w-3/12"></div>
    </div>
    <div class="flex">
      <div class="hidden md:block md:w-3/12"></div>
      <div class="w-full md:w-6/12 max-w-xl">
        <h2 id="drone-community-edition---what-is-included">Drone Community Edition - what is included?</h2>

<p>2019-03-21</p>

<p>I’ve been using Drone 0.8 extensively for 18 months now and enjoyed great success with it.</p>

<p>Drone 1.0 is tagged now on Github and there are a few licensing changes that are worth noting.</p>

<blockquote>
  <p>Warning. I’m no expert on OSS licensing, consult with your legal advisor before you do things based on information published in this blog post.</p>
</blockquote>

<h3 id="the-licensing-landscape-is-rather-confusing">The licensing landscape is rather confusing</h3>

<p>There is information scattered in source code, the Discourse forum and various FAQs and at times they hold conflicting information.</p>

<p>There is a recent <a href="https://discourse.drone.io/t/drone-community-edition/3938" target="\_blank">Discourse thread</a> on it where Brad cleared up some of my concerns.</p>

<p><br />
<img src="images/drone-licensing.png" alt="Drone.io licensing" /></p>

<h3 id="source-code-trumps-everything-in-licensing-questions">Source code trumps everything in licensing questions</h3>

<p>Brad was clear on this one. The source code has the final say of what is part of the drone.io Community Edition.</p>

<p>Since Docker Hub holds the enterprise version going forward, the <code class="highlighter-rouge">drone/drone:1</code> image will have resource limits or it may raise licensing questions that I have no intent to figure out.</p>

<p>Instead I build the code from source to get the pure OSS version: <code class="highlighter-rouge">go build --tags oss github.com/drone/drone/cmd/drone-server</code></p>

<p>The command results in a <code class="highlighter-rouge">drone-server</code> binary that I can start after setting the right environment variables:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DRONE_GITHUB_SERVER=https://github.com \
DRONE_GITHUB_CLIENT_ID=xxx \
DRONE_GITHUB_CLIENT_SECRET=xxx \
DRONE_SERVER_HOST=mydomain.com \
DRONE_SERVER_PROTO=http \
DRONE_USER_CREATE=username:yourgithubusername,admin:true \
DRONE_USER_FILTER=yourgithubusername \
DRONE_LOGS_DEBUG=true \
./drone-server
</code></pre></div></div>

<h3 id="there-are-no-agents-in-the-community-edition">There are no agents in the Community Edition</h3>

<p>Surprisingly agents are not part of the Community Edition.</p>

<p>While the server node can run builds and Drone works in a single node setup, scaling requires the purchase and Enterprise license (or fit in the low volume Drone usage to use the Enterprise version for free).</p>

<p>TI tried building the <code class="highlighter-rouge">drone-agent</code> binary from source and could confirm that is not part of the OSS license.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  drone git:(master) ✗ go build --tags oss github.com/drone/drone/cmd/drone-agent

can't load package: package github.com/drone/drone/cmd/drone-agent: build constraints exclude all Go files in /home/laszlo/projects/drone/cmd/drone-agent
</code></pre></div></div>

<p>Luckilly the <code class="highlighter-rouge">github.com/drone/drone/cmd/drone-agent</code> package is only a thin layer on top of the runner architecture of Drone. The runner source code is part of the Community Edition which we saw earlier when the single node setup ran builds.</p>

<h3 id="the-kubernetes-integration-is-not-part-of-the-community-edition">The Kubernetes integration is not part of the Community Edition</h3>

<p>The same is true about the Kubernetes native builds.</p>

<p>Only a <a href="https://github.com/drone/drone/blob/master/scheduler/kube/kube_oss.go" target="\_blank">“noop” implementation</a> is tagged with <code class="highlighter-rouge">// +build oss</code> thus when you build with <code class="highlighter-rouge">go build --tags oss</code> all you get is pending builds when you try enabling the Kubernetes scheduler.</p>

<h3 id="what-is-the-drone-community-edition-is-good-for-then">What is the Drone Community Edition is good for then?</h3>

<p>Smaller agentless single node setups where the price of running a node 24/7 is not prohibiting.</p>

<p>Price sensitivity varies a lot, some may run a 16 core node and don’t mind the price, but the Community Edition does not scale infinitely.</p>

<p>At least not today. Drone is famous for the clean code and interfaces, I wouldn’t be surprised if community maintained schedulers pop up.</p>

<p>UPDATE:</p>
<ul>
  <li>Also no TLS</li>
  <li>And only SQLite, no Postgres or MySQL backends</li>
  <li>The Enterprise license got cleared up in the meantime. Basically Enterprise is free under 15000 builds a year, no questions asked. It is also free above that limit in a bunch of scenarios. If no special case applies to you than above 15000 builds a year it has a per-user pricing model. <a href="https://discourse.drone.io/t/licensing-and-subscription-faq/3839">Reference</a></li>
</ul>

<p>UPDATE2:</p>
<ul>
  <li>I decided to fork 0.8 and add my opinions. Github, Kubernetes, and other goodies in focus. <a href="https://github.com/laszlocph/drone-oss-08/">It’s on Github</a></li>
</ul>

        <hr />
        <div class="font-sans text-sm text-gray-600">
          <p>Are you running Kubernetes?</p>
          You can bootstrap logging, metrics and ingress with my new project, Gimlet Stack. Head over to <a href="https://gimlet.io/concepts/gimlet-stack-concepts/">gimlet.io</a> and see if it helps you.
        </div>
      </div>
      <div class="hidden md:block md:w-3/12 p-6 pl-8 font-sans text-sm text-gray-600">
        <div class="sticky top-0 pt-4">
  <p class="uppercase"><strong>On this page</strong></p>
  <ul id="toc" class="list-none w-48 pl-0">
  <li class="mb-3"><a href="#the-licensing-landscape-is-rather-confusing" class="font-sans text-sm text-gray-600">The licensing landscape is rather confusing</a></li>
  <li class="mb-3"><a href="#source-code-trumps-everything-in-licensing-questions" class="font-sans text-sm text-gray-600">Source code trumps everything in licensing questions</a></li>
  <li class="mb-3"><a href="#there-are-no-agents-in-the-community-edition" class="font-sans text-sm text-gray-600">There are no agents in the Community Edition</a></li>
  <li class="mb-3"><a href="#the-kubernetes-integration-is-not-part-of-the-community-edition" class="font-sans text-sm text-gray-600">The Kubernetes integration is not part of the Community Edition</a></li>
  <li class="mb-3"><a href="#what-is-the-drone-community-edition-is-good-for-then" class="font-sans text-sm text-gray-600">What is the Drone Community Edition is good for then?</a></li>
</ul>

  <button class="bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded" onclick="document.body.scrollTop=0;document.documentElement.scrollTop=0;">
      Back to top
  </button>
</div>
      </div>
    </div>
  </div>
<!-- Fathom - beautiful, simple website analytics -->
<script src="https://rat.gimlet.io/script.js" site="SWFGFITA" defer></script>
<!-- / Fathom -->

<script type="text/javascript" src="/assets/javascripts/homepage.js" async></script>
</body>
</html>
